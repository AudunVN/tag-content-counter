<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>{%!TITLE!%}</title>

		<link rel="stylesheet" href="../static/datatables/datatables.min.css">
		<link rel="stylesheet" href="../static/main.css">
	</head>
	<body>
		<script>
			/* we have JS, load incoming */
			document.body.classList.add("loading");
		</script>

		<div class="loader">
			Loading...
		</div>

		<main>
			<table class="display">
				{%!TABLE-CONTENTS!%}
			</table>
		</main>

		<script src="../static/datatables/datatables.min.js"></script>

		<script>
			$(document).ready(function() {
				let outputFile = window.location.pathname.split("/").pop().slice(0, -5);

				$.getJSON(`${outputFile}.json`, function(output) {
					let itemCounters = Object.entries(output.itemCounters);

					$("main table").DataTable({
						dom: "Bfrtip",
						buttons: [
							{
								extend: 'copy',
								text: 'Copy page',
								exportOptions: {
									modifier: {
										page: 'current'
									}
								}
							}, 'csv', 'excel'
						],
						data: itemCounters,
						deferRender: true,
						responsive: true,
						order: [[ 1, "desc" ]],
						pageLength: 20,
						"initComplete": function(settings, json) {
							document.body.classList.remove("loading");
						}
					});
				});
			});
		</script>
	</body>
</html>